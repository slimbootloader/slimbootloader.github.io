<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flash Map &mdash; Slim Bootloader 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/sbl_logo_blue_32x32_icon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Memory Map" href="memory-map.html" />
    <link rel="prev" title="Boot Flow" href="boot-flow.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Slim Bootloader
              <img src="../_static/sbl_logo_white_200x200.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supported-hardware/index.html">Supported Hardware</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="source-tree.html">Source Tree Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-system.html">Build System</a></li>
<li class="toctree-l2"><a class="reference internal" href="stitching-ifwi.html">Stitch IFWI Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="fsp.html">Firmware Support Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="boot-flow.html">Boot Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="boot-flow.html#ldrglobal-loader-global-data">LdrGlobal - Loader Global Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="boot-flow.html#end-to-end-call-graph">End-to-End Call Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="boot-flow.html#platform-initialization">Platform Initialization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Flash Map</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#flash-components">Flash Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flash-layout">Flash Layout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="memory-map.html">Memory Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="payload.html">Payloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="osloader.html">OsLoader</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootimage.html">Boot Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="boot-options.html">Boot Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="flash-boot.html">Boot from Flash</a></li>
<li class="toctree-l2"><a class="reference internal" href="versioning.html">Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="boot-performance.html">Boot Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">Shell Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging-with-cca.html">Source Level Debugging with Intel(R) SVT CCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging-with-udk.html">Source Level Debugging with Intel(R) UDK Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributions.html">Contribution Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingredients-update.html">Ingredients upgrade</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-tos/index.html">How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specs/index.html">Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">References and Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/terminology.html">Terminology and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Slim Bootloader</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Developer’s Guide</a></li>
      <li class="breadcrumb-item active">Flash Map</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flash-map">
<h1>Flash Map<a class="headerlink" href="#flash-map" title="Permalink to this heading"></a></h1>
<p>Flash map is a manifest to describe the binary layout in SBL image. With flash map, SBL is able to locate each subcomponent. It also makes it possible for post build script to examine or patch individual component, e.g. configuration data or payload, without having to recompile SBL source.</p>
<p>The flash map data structure is an array based manifest with some header information:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">UINT32</span><span class="w">    </span><span class="n">Signature</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT32</span><span class="w">    </span><span class="n">Flags</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT32</span><span class="w">    </span><span class="n">Offset</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT32</span><span class="w">    </span><span class="n">Size</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">FLASH_MAP_ENTRY_DESC</span><span class="p">;</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">UINT32</span><span class="w">                </span><span class="n">Signature</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT16</span><span class="w">                </span><span class="n">Version</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT16</span><span class="w">                </span><span class="n">Length</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT8</span><span class="w">                 </span><span class="n">Attributes</span><span class="p">;</span>
<span class="w">  </span><span class="n">UINT8</span><span class="w">                 </span><span class="n">Reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="w">  </span><span class="n">UINT32</span><span class="w">                </span><span class="n">RomSize</span><span class="p">;</span>
<span class="w">  </span><span class="n">FLASH_MAP_ENTRY_DESC</span><span class="w">  </span><span class="n">EntryDesc</span><span class="p">[];</span>
<span class="p">}</span><span class="w"> </span><span class="n">FLASH_MAP</span><span class="p">;</span>
</pre></div>
</div>
<p>SBL embeds the flash map structure at an offset in the SBL image so that the flash map is accessible at the following memory address during boot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define FLASH_MAP_ADDRESS       0xFFFFFFF8</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Intel Apollo Lake platform, flash map content is determined at the end of the build process as the size of some subcomponents are not known in advance.</p>
</div>
<section id="flash-components">
<h2>Flash Components<a class="headerlink" href="#flash-components" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signature</p></th>
<th class="head"><p>Component Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SG1A</p></td>
<td><p>Stage 1A</p></td>
</tr>
<tr class="row-odd"><td><p>SG1B</p></td>
<td><p>Stage 1B</p></td>
</tr>
<tr class="row-even"><td><p>SG02</p></td>
<td><p>Stage 2</p></td>
</tr>
<tr class="row-odd"><td><p>ACM0</p></td>
<td><p>ACM module</p></td>
</tr>
<tr class="row-even"><td><p>UCOD</p></td>
<td><p>Microcode Patch</p></td>
</tr>
<tr class="row-odd"><td><p>MRCD</p></td>
<td><p>MRC training data</p></td>
</tr>
<tr class="row-even"><td><p>VARS</p></td>
<td><p>Variable data</p></td>
</tr>
<tr class="row-odd"><td><p>KEYH</p></td>
<td><p>Key hash store</p></td>
</tr>
<tr class="row-even"><td><p>PYLD</p></td>
<td><p>Normal Payload (typically OS loader)</p></td>
</tr>
<tr class="row-odd"><td><p>EPLD</p></td>
<td><p>Extended Payload container (UEFI payload, Linux payload, etc)</p></td>
</tr>
<tr class="row-even"><td><p>IAS1</p></td>
<td><p>First IAS image (typically for provisioning or recovery use)</p></td>
</tr>
<tr class="row-odd"><td><p>IAS2</p></td>
<td><p>Second IAS image</p></td>
</tr>
<tr class="row-even"><td><p>FWUP</p></td>
<td><p>Firmware Update Payload</p></td>
</tr>
<tr class="row-odd"><td><p>CNFG</p></td>
<td><p>External configuration data</p></td>
</tr>
<tr class="row-even"><td><p>_BPM</p></td>
<td><p>Boot Policy Manifest</p></td>
</tr>
<tr class="row-odd"><td><p>OEMK</p></td>
<td><p>OEM Key Manifest</p></td>
</tr>
<tr class="row-even"><td><p>RSVD</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>EMTY</p></td>
<td><p>Empty</p></td>
</tr>
<tr class="row-even"><td><p>UNKN</p></td>
<td><p>Unknown</p></td>
</tr>
</tbody>
</table>
</section>
<section id="flash-layout">
<span id="id1"></span><h2>Flash Layout<a class="headerlink" href="#flash-layout" title="Permalink to this heading"></a></h2>
<p>SBL contains all critical boot components with redundant copy on boot flash so that if one of them is corrupted due to hardware defect or during firmware update process, SBL is able to recover from the 2nd copy to boot, thus avoiding bricking the board in total failure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Apollo Lake platform, flash map is determined in the stitching process instead of build process.</p>
</div>
<p>An flash layout from QEMU build is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flash</span> <span class="n">Map</span> <span class="n">Information</span><span class="p">:</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                              <span class="n">FLASH</span>  <span class="n">MAP</span>                                <span class="o">|</span>
      <span class="o">|</span>                         <span class="p">(</span><span class="n">RomSize</span> <span class="o">=</span> <span class="mh">0x00200000</span><span class="p">)</span>                         <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">NAME</span>   <span class="o">|</span>     <span class="n">OFFSET</span>  <span class="p">(</span><span class="n">BASE</span><span class="p">)</span>     <span class="o">|</span>    <span class="n">SIZE</span>    <span class="o">|</span>         <span class="n">FLAGS</span>         <span class="o">|</span>
      <span class="o">+----------+------------------------+------------+-----------------------+</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                               <span class="n">TOP</span> <span class="n">SWAP</span> <span class="n">A</span>                               <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">SG1A</span>   <span class="o">|</span>  <span class="mh">0x1f8000</span><span class="p">(</span><span class="mh">0xFFFF8000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x008000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span> <span class="n">TS_A</span>   <span class="o">|</span>
      <span class="o">|</span>   <span class="n">EMTY</span>   <span class="o">|</span>  <span class="mh">0x1f0000</span><span class="p">(</span><span class="mh">0xFFFF0000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x008000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span> <span class="n">TS_A</span>   <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                               <span class="n">TOP</span> <span class="n">SWAP</span> <span class="n">B</span>                               <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">SG1A</span>   <span class="o">|</span>  <span class="mh">0x1e8000</span><span class="p">(</span><span class="mh">0xFFFE8000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x008000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span> <span class="n">TS_B</span>   <span class="o">|</span>
      <span class="o">|</span>   <span class="n">EMTY</span>   <span class="o">|</span>  <span class="mh">0x1e0000</span><span class="p">(</span><span class="mh">0xFFFE0000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x008000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span> <span class="n">TS_B</span>   <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                              <span class="n">REDUNDANT</span> <span class="n">A</span>                               <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">CNFG</span>   <span class="o">|</span>  <span class="mh">0x1df000</span><span class="p">(</span><span class="mh">0xFFFDF000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x001000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span> <span class="n">R_A</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">FWUP</span>   <span class="o">|</span>  <span class="mh">0x1bf000</span><span class="p">(</span><span class="mh">0xFFFBF000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x020000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span> <span class="n">R_A</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">SG1B</span>   <span class="o">|</span>  <span class="mh">0x1a0000</span><span class="p">(</span><span class="mh">0xFFFA0000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x01f000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span> <span class="n">R_A</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">SG02</span>   <span class="o">|</span>  <span class="mh">0x180000</span><span class="p">(</span><span class="mh">0xFFF80000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x020000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span> <span class="n">R_A</span>    <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                              <span class="n">REDUNDANT</span> <span class="n">B</span>                               <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">CNFG</span>   <span class="o">|</span>  <span class="mh">0x17f000</span><span class="p">(</span><span class="mh">0xFFF7F000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x001000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span> <span class="n">R_B</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">FWUP</span>   <span class="o">|</span>  <span class="mh">0x15f000</span><span class="p">(</span><span class="mh">0xFFF5F000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x020000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span> <span class="n">R_B</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">SG1B</span>   <span class="o">|</span>  <span class="mh">0x140000</span><span class="p">(</span><span class="mh">0xFFF40000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x01f000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span> <span class="n">R_B</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">SG02</span>   <span class="o">|</span>  <span class="mh">0x120000</span><span class="p">(</span><span class="mh">0xFFF20000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x020000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span> <span class="n">R_B</span>    <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                             <span class="n">NON</span> <span class="n">REDUNDANT</span>                              <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">PYLD</span>   <span class="o">|</span>  <span class="mh">0x020000</span><span class="p">(</span><span class="mh">0xFFE20000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x100000</span>  <span class="o">|</span>  <span class="n">Compressed</span>  <span class="p">,</span>  <span class="n">NR</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">VARS</span>   <span class="o">|</span>  <span class="mh">0x01e000</span><span class="p">(</span><span class="mh">0xFFE1E000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x002000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span>  <span class="n">NR</span>    <span class="o">|</span>
      <span class="o">|</span>   <span class="n">EMTY</span>   <span class="o">|</span>  <span class="mh">0x001000</span><span class="p">(</span><span class="mh">0xFFE01000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x01d000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span>  <span class="n">NR</span>    <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>                              <span class="n">NON</span> <span class="n">VOLATILE</span>                              <span class="o">|</span>
      <span class="o">+------------------------------------------------------------------------+</span>
      <span class="o">|</span>   <span class="n">RSVD</span>   <span class="o">|</span>  <span class="mh">0x000000</span><span class="p">(</span><span class="mh">0xFFE00000</span><span class="p">)</span>  <span class="o">|</span>  <span class="mh">0x001000</span>  <span class="o">|</span>  <span class="n">Uncompressed</span><span class="p">,</span>  <span class="n">NV</span>    <span class="o">|</span>
      <span class="o">+----------+------------------------+------------+-----------------------+</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The flash map changes when firmware resiliency and recovery is enabled (see <a class="reference internal" href="../security/firmware-resiliency-and-recovery.html#firmware-resiliency-and-recovery"><span class="std std-ref">Firmware Resiliency and Recovery</span></a>).</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="boot-flow.html" class="btn btn-neutral float-left" title="Boot Flow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="memory-map.html" class="btn btn-neutral float-right" title="Memory Map" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018 - 2025, Intel Corporation.
      <span class="lastupdated">Last updated on Jun 27, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>